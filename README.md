# findDevice
Приложение для поиска устройств в локальной сети и по Bluetooth. Показывает найденные устройства, сохраняет историю сканирований и позволяет просматривать детали каждого устройства.
---
## Основной функционал
### Сканирование Bluetooth‑устройств
- Поиск устройств поблизости через **CoreBluetooth**
- Отображение для каждого устройства:
  - имя
  - UUID
  - уровень сигнала (RSSI)
  - статус (подключено / отключено / неизвестно)
- Обработка ошибок:
  - Bluetooth выключен
  - нет разрешения на использование Bluetooth
  - Bluetooth не поддерживается на устройстве
  - 
### Сканирование LAN (Wi‑Fi)
- Использует библиотеку **LanScanner**
- Поиск устройств в текущей Wi‑Fi сети
- Отображение для каждого устройства:
  - IP‑адрес
  - имя устройства (hostname, если доступен)
  - MAC‑адрес (если система позволяет, иначе скрывается как недоступный)
- Проверка доступа к локальной сети через `NWPathMonitor`
- Прогресс‑бар с плавным заполнением (комбинация реального прогресса от LanScanner и «временного» прогресса по таймеру)

### Сохранение и история
- Локальное хранилище на **Realm**
- Сохранение:
  - сессий сканирования (`ScanSession`)
  - устройств (`Device`) с привязкой к конкретной сессии
- Экран истории:
  - список всех сессий с датой/временем и количеством найденных устройств
  - просмотр устройств внутри выбранной сессии
  - поиск по имени устройства
  - удаление сессий

### Экран деталей устройства
- Общая информация:
  - имя
  - тип (Bluetooth / LAN)
  - статус
- Для Bluetooth‑устройств:
  - UUID
  - RSSI
- Для LAN‑устройств:
  - IP‑адрес
  - MAC‑адрес (если доступен)
- Дополнительно:
  - дата создания записи в базе

---

## UI / UX
### Главный экран (Сканирование)
- Кнопка «Сканировать» / «Остановить»
- Анимация **Lottie** (`scanning.json`) во время сканирования
- Прогресс‑бар c плавным ростом
- Список найденных устройств, разбитый на секции:
  - Bluetooth устройства
  - LAN устройства
- Переход к экрану деталей по тапу на устройство (через `NavigationLink`)

### Экран истории
- Список сессий сканирования
- Поиск по имени устройства
- Переход к списку устройств выбранной сессии
- Пуш‑навигация к экрану деталей устройства

### Экран деталей
- Обычный экран в `NavigationView` (без модальных sheet)
- Навбар со стандартной кнопкой «Назад» к предыдущему экрану

---

## Архитектура
- **Паттерн**: MVVM
- **Слои**:
  - `Models`
    - `Device` — сущность устройства (Realm‑модель)
    - `ScanSession` — сессия сканирования (Realm‑модель)
    - `DeviceType`, `DeviceStatus` — enum’ы с маппингом на строковые поля Realm
  - `Services`
    - `BluetoothService` — работа с CoreBluetooth (сканирование, ошибки)
    - `LANService` — работа с LanScanner и проверкой сети через `NWPathMonitor`
    - `DatabaseService` — обёртка над Realm (запись, выборка, удаление)
  - `ViewModels`
    - `ScanViewModel` — логика главного экрана:
      - запуск/остановка сканирования
      - прогресс‑бар (время + реальный прогресс)
      - сохранение результатов в базу
    - `HistoryViewModel` — логика истории:
      - загрузка сессий
      - фильтрация по имени устройства
      - удаление сессий
  - `Views`
    - `MainTabView`, `ScanningView`, `DevicesListView`, `HistoryView`, `DeviceDetailView`, `LaunchScreenView` и др.
  - `Utilities`
    - `LottieView` — обёртка над Lottie через `UIViewRepresentable`

---

## Технологии
- **Язык**: Swift 5
- **UI**: SwiftUI
- **Минимальная iOS**: 15.6
- **Зависимости (Swift Package Manager)**:
  - [`lan-scanner`](https://github.com/MaatheusGois/lan-scanner) — сканирование LAN
  - [`lottie-ios`](https://github.com/airbnb/lottie-ios) — анимация
  - [`realm-swift`](https://github.com/realm/realm-swift) — локальная база данных

---

## Обработка ошибок
### Bluetooth
- Показывается алерт, если:
  - Bluetooth выключен
  - нет разрешения на использование Bluetooth
  - Bluetooth не поддерживается на устройстве

### LAN / Wi‑Fi
- Перед стартом сканирования:
  - проверяется доступ к локальной сети (`NWPathMonitor(requiredInterfaceType: .wifi)`)
  - если сети нет, сканирование не запускается, а пользователь видит алерт:
    - «Нет доступа к локальной сети. Подключитесь к Wi‑Fi.»
- Ошибки из LanScanner (и других сервисов) через `errorMessage` попадают в `ScanViewModel` и отображаются в виде алертов.

---

## Ограничения
- **MAC‑адреса LAN‑устройств**
  - На современных версиях iOS получение реальных MAC‑адресов по сети ограничено.
  - Библиотека может возвращать заглушку `02:00:00:00:00:00`; в UI такое значение можно скрывать или отображать как «Недоступно».
- **Сканирование во времени**
  - Сканирование ограничено `scanDuration` (по умолчанию 15 секунд, можно изменить в `ScanViewModel`).
  - Прогресс‑бар комбинирует «временной» прогресс (по таймеру) и реальный прогресс LanScanner.
